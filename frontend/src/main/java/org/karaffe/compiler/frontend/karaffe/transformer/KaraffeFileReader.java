package org.karaffe.compiler.frontend.karaffe.transformer;

import org.antlr.v4.runtime.ANTLRFileStream;
import org.antlr.v4.runtime.CommonTokenStream;
import org.karaffe.compiler.frontend.karaffe.antlrautogenerated.KaraffeLexer;
import org.karaffe.compiler.frontend.karaffe.transformer.util.PhaseResult;

import java.io.File;
import java.io.IOException;

public class KaraffeFileReader extends AbstractFileTransformer<CommonTokenStream> {

    @Override
    public String phaseName() {
        return "file-reader";
    }

    @Override
    public String phaseDescription() {
        return "read karaffe file";
    }

    @Override
    public PhaseResult<CommonTokenStream> run(File input) {
        try {
            KaraffeLexer lexer = new KaraffeLexer(new ANTLRFileStream(input.getAbsolutePath()));
            return PhaseResult.onSuccess(new CommonTokenStream(lexer));
        } catch (IOException e) {
            throw new PhaseException(e);
        }
    }

    @Override
    public boolean changed() {
        return false;
    }
}
